function formatBytes(e,t=2){if(!+e)return"0 Bytes";const i=0>t?0:t,n=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,n)).toFixed(i))} ${["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}`}function fixFilename(e){return(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.toLowerCase()).replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a")).replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e")).replace(/ì|í|ị|ỉ|ĩ/g,"i")).replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o")).replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u")).replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y")).replace(/đ/g,"d")).replace(/\u0300|\u0301|\u0303|\u0309|\u0323/g,"")).replace(/\u02C6|\u0306|\u031B/g,"")).replace(/ + /g,"_")).trim()).replace(/!|@|%|\^|\*|\(|\)|\+|\=| |\<|\>|\?|\/|,|\.|\:|\;|\'|\"|\&|\#|\[|\]|~|\$|_|`|-|{|}|\||\\/g,"_")}function update_file_status(e,t){const i=JSON.parse(t);console.log(t),i.data.id?pdfs.push({id_upload:e,id_be:i.data.id}):console.log("Alert error")}function ui_converting(){$("#handle-upload").removeClass("active"),$("#task-process").addClass("active"),$(".converter-footer").addClass("disabled")}function ui_show_preview(e,t,i){var n=t.name.replace(/\.[^/.]+$/,"");n=fixFilename(n),"application/pdf"!=t.type||"pdf"!==i&&"1"!==i?"application/vnd.openxmlformats-officedocument.wordprocessingml.document"!==t.type&&"application/msword"!==t.type||"word"!==i&&"1"!==i?alert("Unsupported format"):($("#pdfItems").append('<div class="pdf-item" id="'+e+'" data-filename="'+n+'"><div class="file-info uploading"><div class="preview-icon preview-icon--word"></div><div class="pdf-filename">'+t.name+'</div><div class="pdf-file-size">'+formatBytes(t.size)+'</div></div><div class="progress-bar"></div><div class="item-del" onclick="removeItem(\''+e+'\')"><svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.3268 6.00028L11.0377 2.28935C11.2139 2.11354 11.3129 1.87496 11.3131 1.62611C11.3134 1.37726 11.2147 1.13851 11.0389 0.962393C10.8631 0.786273 10.6245 0.687206 10.3757 0.686986C10.1268 0.686766 9.88807 0.785412 9.71195 0.961221L6.00102 4.67216L2.29008 0.961221C2.11396 0.785101 1.87509 0.686157 1.62602 0.686157C1.37694 0.686157 1.13807 0.785101 0.961953 0.961221C0.785833 1.13734 0.68689 1.37621 0.68689 1.62528C0.68689 1.87436 0.785833 2.11323 0.961953 2.28935L4.67289 6.00028L0.961953 9.71122C0.785833 9.88734 0.68689 10.1262 0.68689 10.3753C0.68689 10.6244 0.785833 10.8632 0.961953 11.0393C1.13807 11.2155 1.37694 11.3144 1.62602 11.3144C1.87509 11.3144 2.11396 11.2155 2.29008 11.0393L6.00102 7.32841L9.71195 11.0393C9.88807 11.2155 10.1269 11.3144 10.376 11.3144C10.6251 11.3144 10.864 11.2155 11.0401 11.0393C11.2162 10.8632 11.3151 10.6244 11.3151 10.3753C11.3151 10.1262 11.2162 9.88734 11.0401 9.71122L7.3268 6.00028Z" fill="#5C5D6B"></path></svg></div></div>'),$("#upload").addClass("disabled"),$("#converter").addClass("d-block"),$("#convert-wrapper").removeClass("disabled"),$("#handle-upload").addClass("active"),$("body").addClass("d-scroll")):($("#pdfItems").append('<div class="pdf-item" id="'+e+'" data-filename="'+n+'"><div class="file-info uploading"><div class="preview-icon"></div><div class="pdf-filename">'+t.name+'</div><div class="pdf-file-size">'+formatBytes(t.size)+'</div></div><div class="progress-bar"></div><div class="item-del" onclick="removeItem(\''+e+'\')"><svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.3268 6.00028L11.0377 2.28935C11.2139 2.11354 11.3129 1.87496 11.3131 1.62611C11.3134 1.37726 11.2147 1.13851 11.0389 0.962393C10.8631 0.786273 10.6245 0.687206 10.3757 0.686986C10.1268 0.686766 9.88807 0.785412 9.71195 0.961221L6.00102 4.67216L2.29008 0.961221C2.11396 0.785101 1.87509 0.686157 1.62602 0.686157C1.37694 0.686157 1.13807 0.785101 0.961953 0.961221C0.785833 1.13734 0.68689 1.37621 0.68689 1.62528C0.68689 1.87436 0.785833 2.11323 0.961953 2.28935L4.67289 6.00028L0.961953 9.71122C0.785833 9.88734 0.68689 10.1262 0.68689 10.3753C0.68689 10.6244 0.785833 10.8632 0.961953 11.0393C1.13807 11.2155 1.37694 11.3144 1.62602 11.3144C1.87509 11.3144 2.11396 11.2155 2.29008 11.0393L6.00102 7.32841L9.71195 11.0393C9.88807 11.2155 10.1269 11.3144 10.376 11.3144C10.6251 11.3144 10.864 11.2155 11.0401 11.0393C11.2162 10.8632 11.3151 10.6244 11.3151 10.3753C11.3151 10.1262 11.2162 9.88734 11.0401 9.71122L7.3268 6.00028Z" fill="#5C5D6B"></path></svg></div></div>'),$("#upload").addClass("disabled"),$("#converter").addClass("d-block"),$("#convert-wrapper").removeClass("disabled"),$("#handle-upload").addClass("active"),$("body").addClass("d-scroll"))}function ui_update_pdf_progress(e,t,i,n){console.log("id: "+e+" - "+t),color="undefined"!=typeof color&&color,n=void 0===n||n;var s=$("#"+e).find("div.progress-bar");s.width(t+"%").attr("aria-valuenow",t),s.toggleClass("progress-bar-striped progress-bar-animated",n),!1!==i&&(s.removeClass("progress-bar-striped progress-bar-animated"),s.addClass(i),"progress-success"===i&&$("#"+e).find(".file-info").removeClass("uploading"))}function getItems(){countPDF=$(".pdf-item").length;for(var e=[],t=0;t<countPDF;t++){countPdfArr=pdfs.length;for(var i=0;i<countPdfArr;i++)$(".pdf-item")[t].id===pdfs[i].id_upload&&e.push({id:pdfs[i].id_be,name:$("#"+pdfs[i].id_upload).data("filename")})}return e}function getTaskId(e){$.ajax({url:"/tasks.php",method:"POST",data:e,success:function(e){obj=jQuery.parseJSON(e),getTaskResult(obj.task_id)},error:function(){showAlertError("Can't connect to api, please try again")}})}function getTaskResult(e){$.ajax({url:"/tasks.php?id="+e,method:"get",success:function(t){if(obj=jQuery.parseJSON(t),"PENDING"===obj.task_status||"STARTED"===obj.task_status)setTimeout(function(){getTaskResult(e)},200);else if("SUCCESS"===obj.task_status){obj.task_result.data;showResult(obj.task_result.data)}else showAlertError(obj.task_result.error)},error:function(){showAlertError("Can't connect to api, please try again")}})}function showAlertError(e){alert(e),$("#handle-upload").addClass("active"),$("#task-process").removeClass("active"),$(".converter-footer").removeClass("disabled")}function showResult(e){$("#convert-wrapper").addClass("disabled"),$("#download-final").addClass("active"),$("#download-btn").attr("href",e.url),$("#downloadFilename").text(e.file_name+"."+e.output_file),"pdf"===e.output_file?$("#download-icon").html('<div class="preview-icon"></div>'):"docx"===e.output_file?$("#download-icon").html('<div class="preview-icon preview-icon--word"></div>'):"zip"===e.output_file&&$("#download-icon").html('<div class="preview-icon preview-icon--zip"></div>'),$("#dlFileSize").text(formatBytes(e.file_size)),$(".settings")?($(".settings").html('<div class="adload"><img src="https://place-hold.it/300x500?text=ADS" alt="" width="100%"></div>'),$(".btn-settings").addClass("disabled")):console.log("khong ton tai")}!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){"use strict";var t="dmUploader",i=0,n=1,s=2,o=3,a=4,r={auto:!0,queue:!0,dnd:!0,hookDocument:!0,multiple:!0,url:document.URL,method:"POST",extraData:{},headers:{},dataType:null,fieldName:"file",maxFileSize:0,allowedTypes:"*",extFilter:null,onInit:function(){},onComplete:function(){},onFallbackMode:function(){},onNewFile:function(){},onBeforeUpload:function(){},onUploadProgress:function(){},onUploadSuccess:function(){},onUploadCanceled:function(){},onUploadError:function(){},onUploadComplete:function(){},onFileTypeError:function(){},onFileSizeError:function(){},onFileExtError:function(){},onDragEnter:function(){},onDragLeave:function(){},onDocumentDragEnter:function(){},onDocumentDragLeave:function(){}},l=function(e,t){this.data=e,this.widget=t,this.jqXHR=null,this.status=i,this.id=Math.random().toString(36).substr(2)};l.prototype.upload=function(){var t=this;if(!t.canUpload())return t.widget.queueRunning&&t.status!==n&&t.widget.processQueue(),!1;var i=new FormData;i.append(t.widget.settings.fieldName,t.data);var s=t.widget.settings.extraData;return"function"==typeof s&&(s=s.call(t.widget.element,t.id)),e.each(s,function(e,t){i.append(e,t)}),t.status=n,t.widget.activeFiles++,t.widget.settings.onBeforeUpload.call(t.widget.element,t.id),t.jqXHR=e.ajax({url:t.widget.settings.url,type:t.widget.settings.method,dataType:t.widget.settings.dataType,data:i,headers:t.widget.settings.headers,cache:!1,contentType:!1,processData:!1,forceSync:!1,xhr:function(){return t.getXhr()},success:function(e){t.onSuccess(e)},error:function(e,i,n){t.onError(e,i,n)},complete:function(){t.onComplete()}}),!0},l.prototype.onSuccess=function(e){this.status=s,this.widget.settings.onUploadSuccess.call(this.widget.element,this.id,e)},l.prototype.onError=function(e,t,i){this.status!==a&&(this.status=o,this.widget.settings.onUploadError.call(this.widget.element,this.id,e,t,i))},l.prototype.onComplete=function(){this.widget.activeFiles--,this.status!==a&&this.widget.settings.onUploadComplete.call(this.widget.element,this.id),this.widget.queueRunning?this.widget.processQueue():this.widget.settings.queue&&0===this.widget.activeFiles&&this.widget.settings.onComplete.call(this.element)},l.prototype.getXhr=function(){var t=this,i=e.ajaxSettings.xhr();return i.upload&&i.upload.addEventListener("progress",function(e){var i=0,n=e.loaded||e.position,s=e.total||e.totalSize;e.lengthComputable&&(i=Math.ceil(n/s*100)),t.widget.settings.onUploadProgress.call(t.widget.element,t.id,i)},!1),i},l.prototype.cancel=function(e){e=void 0!==e&&e;var t=this.status;return!!(t===n||e&&t===i)&&(this.status=a,this.widget.settings.onUploadCanceled.call(this.widget.element,this.id),t===n&&this.jqXHR.abort(),!0)},l.prototype.canUpload=function(){return this.status===i||this.status===o};var d=function(t,i){return this.element=e(t),this.settings=e.extend({},r,i),this.checkSupport()?(this.init(),this):(e.error("Browser not supported by jQuery.dmUploader"),this.settings.onFallbackMode.call(this.element),!1)};d.prototype.checkSupport=function(){return void 0!==window.FormData&&(!new RegExp("/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1.0|2.0|2.5|3.0))/").test(window.navigator.userAgent)&&!e('<input type="file" />').prop("disabled"))},d.prototype.init=function(){var i=this;this.queue=[],this.queuePos=-1,this.queueRunning=!1,this.activeFiles=0,this.draggingOver=0,this.draggingOverDoc=0;var n=i.element.is("input[type=file]")?i.element:i.element.find("input[type=file]");return n.length>0&&(n.prop("multiple",this.settings.multiple),n.on("change."+t,function(t){var n=t.target&&t.target.files;n&&n.length&&(i.addFiles(n),e(this).val(""))})),this.settings.dnd&&this.initDnD(),0!==n.length||this.settings.dnd?(this.settings.onInit.call(this.element),this):(e.error("Markup error found by jQuery.dmUploader"),null)},d.prototype.initDnD=function(){var i=this;i.element.on("drop."+t,function(e){e.preventDefault(),i.draggingOver>0&&(i.draggingOver=0,i.settings.onDragLeave.call(i.element));var t=e.originalEvent&&e.originalEvent.dataTransfer;if(t&&t.files&&t.files.length){var n=[];i.settings.multiple?n=t.files:n.push(t.files[0]),i.addFiles(n)}}),i.element.on("dragenter."+t,function(e){e.preventDefault(),0===i.draggingOver&&i.settings.onDragEnter.call(i.element),i.draggingOver++}),i.element.on("dragleave."+t,function(e){e.preventDefault(),i.draggingOver--,0===i.draggingOver&&i.settings.onDragLeave.call(i.element)}),i.settings.hookDocument&&(e(document).off("drop."+t).on("drop."+t,function(e){e.preventDefault(),i.draggingOverDoc>0&&(i.draggingOverDoc=0,i.settings.onDocumentDragLeave.call(i.element))}),e(document).off("dragenter."+t).on("dragenter."+t,function(e){e.preventDefault(),0===i.draggingOverDoc&&i.settings.onDocumentDragEnter.call(i.element),i.draggingOverDoc++}),e(document).off("dragleave."+t).on("dragleave."+t,function(e){e.preventDefault(),i.draggingOverDoc--,0===i.draggingOverDoc&&i.settings.onDocumentDragLeave.call(i.element)}),e(document).off("dragover."+t).on("dragover."+t,function(e){e.preventDefault()}))},d.prototype.releaseEvents=function(){this.element.off("."+t),this.element.find("input[type=file]").off("."+t),this.settings.hookDocument&&e(document).off("."+t)},d.prototype.validateFile=function(t){if(this.settings.maxFileSize>0&&t.size>this.settings.maxFileSize)return this.settings.onFileSizeError.call(this.element,t),!1;if("*"!==this.settings.allowedTypes&&!t.type.match(this.settings.allowedTypes))return this.settings.onFileTypeError.call(this.element,t),!1;if(null!==this.settings.extFilter){var i=t.name.toLowerCase().split(".").pop();if(e.inArray(i,this.settings.extFilter)<0)return this.settings.onFileExtError.call(this.element,t),!1}return new l(t,this)},d.prototype.addFiles=function(e){for(var t=0,i=0;i<e.length;i++){var n=this.validateFile(e[i]);n&&!1!==this.settings.onNewFile.call(this.element,n.id,n.data)&&(this.settings.auto&&!this.settings.queue&&n.upload(),this.queue.push(n),t++)}return 0===t?this:(this.settings.auto&&this.settings.queue&&!this.queueRunning&&this.processQueue(),this)},d.prototype.processQueue=function(){return this.queuePos++,this.queuePos>=this.queue.length?(0===this.activeFiles&&this.settings.onComplete.call(this.element),this.queuePos=this.queue.length-1,this.queueRunning=!1,!1):(this.queueRunning=!0,this.queue[this.queuePos].upload())},d.prototype.restartQueue=function(){this.queuePos=-1,this.queueRunning=!1,this.processQueue()},d.prototype.findById=function(e){for(var t=!1,i=0;i<this.queue.length;i++)if(this.queue[i].id===e){t=this.queue[i];break}return t},d.prototype.cancelAll=function(){var e=this.queueRunning;this.queueRunning=!1;for(var t=0;t<this.queue.length;t++)this.queue[t].cancel();e&&this.settings.onComplete.call(this.element)},d.prototype.startAll=function(){if(this.settings.queue)this.restartQueue();else for(var e=0;e<this.queue.length;e++)this.queue[e].upload()},d.prototype.methods={start:function(t){if(this.queueRunning)return!1;var n=!1;return void 0===t||(n=this.findById(t))?n?(n.status===a&&(n.status=i),n.upload()):(this.startAll(),!0):(e.error("File not found in jQuery.dmUploader"),!1)},cancel:function(t){var i=!1;return void 0===t||(i=this.findById(t))?i?i.cancel(!0):(this.cancelAll(),!0):(e.error("File not found in jQuery.dmUploader"),!1)},reset:function(){return this.cancelAll(),this.queue=[],this.queuePos=-1,this.activeFiles=0,!0},destroy:function(){this.cancelAll(),this.releaseEvents(),this.element.removeData(t)}},e.fn.dmUploader=function(i){var n=arguments;if("string"!=typeof i)return this.each(function(){e.data(this,t)||e.data(this,t,new d(this,i))});this.each(function(){var s=e.data(this,t);s instanceof d?"function"==typeof s.methods[i]?s.methods[i].apply(s,Array.prototype.slice.call(n,1)):e.error("Method "+i+" does not exist in jQuery.dmUploader"):e.error("Unknown plugin data found by jQuery.dmUploader")})}});