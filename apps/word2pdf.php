<?php
/**
 * Config
 */
// $multiLanguage = true;
$isCanonical = $isHomeUrl;
// include 
include '../inc/config.php';
include '../inc/header.php';
?>

<div class="main-cover">
    <div class="container mt-3">
        <div class="upload" id="upload">
            <div class="title-wrapper">
                <div class="title-page">
                    <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.777832 12.6443C0.777832 10.7022 2.33339 9.12878 4.25372 9.12878H14.4193C16.3396 9.12878 17.8959 10.7022 17.8959 12.6443V22.9281C17.8959 24.8702 16.3396 26.4445 14.4193 26.4445H4.2545C2.33339 26.4445 0.777832 24.8702 0.777832 22.9289V12.6436V12.6443Z" fill="#005EEB"/><path d="M6.94162 21.014L5.58829 14.5336C5.57383 14.4646 5.57462 14.3932 5.59061 14.3246C5.6066 14.2559 5.63739 14.1916 5.68085 14.1361C5.72199 14.0791 5.77647 14.0331 5.83952 14.0021C5.90257 13.971 5.97226 13.9559 6.04251 13.958C6.2074 13.958 6.35596 14.014 6.48662 14.126C6.61729 14.2302 6.69662 14.3663 6.72462 14.5336L7.74662 20.3233C7.74662 20.3311 7.74973 20.3342 7.75673 20.3342C7.76373 20.3342 7.76685 20.3303 7.76685 20.3233L8.7904 14.5429C8.82159 14.3814 8.90493 14.2347 9.02762 14.1252C9.15359 14.0155 9.31556 13.9559 9.48262 13.958H9.75096C9.92362 13.958 10.0745 14.0132 10.206 14.1252C10.3366 14.2364 10.416 14.3757 10.4432 14.5429L11.4667 20.3233C11.4667 20.3311 11.4698 20.3342 11.4768 20.3342C11.4838 20.3342 11.487 20.3303 11.487 20.3233L12.5105 14.5118C12.5355 14.3564 12.6162 14.2153 12.7376 14.1151C12.8594 14.0134 13.013 13.9575 13.1716 13.9572C13.2402 13.956 13.308 13.9716 13.3692 14.0027C13.4303 14.0337 13.4829 14.0793 13.5224 14.1353C13.5686 14.185 13.6014 14.2456 13.6178 14.3115C13.6341 14.3773 13.6334 14.4463 13.6157 14.5118L12.2515 21.014C12.218 21.1795 12.1264 21.3277 11.9933 21.4317C11.8647 21.5351 11.7041 21.5904 11.5391 21.588H11.3213C11.1545 21.5899 10.9928 21.5304 10.8671 21.4208C10.7441 21.3114 10.6605 21.1646 10.6291 21.0031L9.60629 15.2227C9.60629 15.2149 9.60318 15.2118 9.59618 15.2118C9.58918 15.2118 9.58607 15.2157 9.58607 15.2227L8.56251 21.0031C8.53715 21.1669 8.45278 21.3157 8.32529 21.4216C8.19929 21.5312 8.03734 21.5908 7.87029 21.5888H7.65329C7.48501 21.5901 7.32119 21.5347 7.18818 21.4317C7.06023 21.3246 6.97291 21.1769 6.94085 21.0132L6.94162 21.014Z" fill="white"/><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7237 2.09617H23.0137C24.1881 2.09617 25.1409 3.05983 25.1409 4.24828V14.6581C25.1409 15.8465 24.1889 16.8094 23.0145 16.8094H18.7981V18.1285H23.0137C24.9084 18.1285 26.4445 16.5745 26.4445 14.6581V4.24828C26.4445 2.33105 24.9084 0.777832 23.0145 0.777832H12.7237C10.829 0.777832 9.2937 2.33105 9.2937 4.24828V8.33705H10.5965V4.24828C10.5965 3.05983 11.5485 2.09617 12.7237 2.09617Z" fill="#005EEB"/><path fill-rule="evenodd" clip-rule="evenodd" d="M13.7246 6.0962C13.7246 5.73142 14.0163 5.43665 14.3764 5.43665H21.4145C21.7746 5.43665 22.0663 5.7322 22.0663 6.0962C22.0671 6.26996 21.9989 6.43694 21.8767 6.56047C21.7545 6.68399 21.5883 6.75395 21.4145 6.75498H14.3756C14.202 6.75375 14.0359 6.68369 13.9139 6.56019C13.7919 6.43669 13.7238 6.26983 13.7246 6.0962Z" fill="#005EEB"/><path fill-rule="evenodd" clip-rule="evenodd" d="M23.0144 0.777832C24.9083 0.777832 26.4444 2.33105 26.4444 4.24828V14.6581C26.4444 16.5745 24.9083 18.1285 23.0144 18.1285H18.7981V16.8094H23.0136C24.1881 16.8094 25.1408 15.8465 25.1408 14.6581V4.24828C25.1408 3.05983 24.1888 2.09617 23.0144 2.09617H12.7236C11.5492 2.09617 10.5964 3.05983 10.5964 4.24828V8.33705H9.29285V4.24828C9.29285 2.33105 10.829 0.777832 12.7228 0.777832H23.0144Z" fill="#005EEB"/><path fill-rule="evenodd" clip-rule="evenodd" d="M18.9381 9.34815C18.9381 8.98415 19.1567 8.6886 19.4266 8.6886H21.5771C21.8478 8.6886 22.0663 8.98415 22.0663 9.34815C22.0663 9.71215 21.8478 10.0069 21.5771 10.0069H19.4266C19.1567 10.0069 18.9381 9.71138 18.9381 9.34815ZM18.9381 12.6C18.9381 12.236 19.2298 11.9413 19.5899 11.9413H21.4146C21.7747 11.9413 22.0663 12.2368 22.0663 12.6C22.0669 12.6861 22.0504 12.7715 22.0179 12.8513C21.9854 12.931 21.9376 13.0036 21.8771 13.0648C21.8165 13.1261 21.7445 13.1748 21.6652 13.2082C21.5858 13.2416 21.5007 13.2591 21.4146 13.2596H19.5899C19.5038 13.2591 19.4186 13.2416 19.3393 13.2082C19.2599 13.1748 19.1879 13.1261 19.1274 13.0648C19.0669 13.0036 19.019 12.931 18.9865 12.8513C18.9541 12.7715 18.9376 12.6861 18.9381 12.6Z" fill="#005EEB"/></svg>
                    <h1 class="page-title">Word to PDF</h1>
                </div>
                <h2 class="page-subtitle">Magically convert PDFs to editable Word files</h2>
            </div>
            <div class="upload-box" id="upload-box">
                <div id="drop-area" class="drop-area">
                    <label for="file" class="label-upload"><svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.5 11H13.5V5C13.5 4.73478 13.3946 4.48043 13.2071 4.29289C13.0196 4.10536 12.7652 4 12.5 4C12.2348 4 11.9804 4.10536 11.7929 4.29289C11.6054 4.48043 11.5 4.73478 11.5 5V11H5.5C5.23478 11 4.98043 11.1054 4.79289 11.2929C4.60536 11.4804 4.5 11.7348 4.5 12C4.5 12.2652 4.60536 12.5196 4.79289 12.7071C4.98043 12.8946 5.23478 13 5.5 13H11.5V19C11.5 19.2652 11.6054 19.5196 11.7929 19.7071C11.9804 19.8946 12.2348 20 12.5 20C12.7652 20 13.0196 19.8946 13.2071 19.7071C13.3946 19.5196 13.5 19.2652 13.5 19V13H19.5C19.7652 13 20.0196 12.8946 20.2071 12.7071C20.3946 12.5196 20.5 12.2652 20.5 12C20.5 11.7348 20.3946 11.4804 20.2071 11.2929C20.0196 11.1054 19.7652 11 19.5 11Z" fill="white"/></svg>Upload</label>
                    <input type="file" accept=".doc,.docx" id="file">
                </div>
            </div>

        </div>
    </div>

</div>

<div class="converter" id="converter">
    <div class="converter-content">
        <div class="converter-body">
            <div>
                <div class="container">
                    <div class="convert-wrapper" id="convert-wrapper">
                        <div class="title-wrapper">
                            <div class="title-page">
                                <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.777832 12.6443C0.777832 10.7022 2.33339 9.12878 4.25372 9.12878H14.4193C16.3396 9.12878 17.8959 10.7022 17.8959 12.6443V22.9281C17.8959 24.8702 16.3396 26.4445 14.4193 26.4445H4.2545C2.33339 26.4445 0.777832 24.8702 0.777832 22.9289V12.6436V12.6443Z" fill="#005EEB"/><path d="M6.94162 21.014L5.58829 14.5336C5.57383 14.4646 5.57462 14.3932 5.59061 14.3246C5.6066 14.2559 5.63739 14.1916 5.68085 14.1361C5.72199 14.0791 5.77647 14.0331 5.83952 14.0021C5.90257 13.971 5.97226 13.9559 6.04251 13.958C6.2074 13.958 6.35596 14.014 6.48662 14.126C6.61729 14.2302 6.69662 14.3663 6.72462 14.5336L7.74662 20.3233C7.74662 20.3311 7.74973 20.3342 7.75673 20.3342C7.76373 20.3342 7.76685 20.3303 7.76685 20.3233L8.7904 14.5429C8.82159 14.3814 8.90493 14.2347 9.02762 14.1252C9.15359 14.0155 9.31556 13.9559 9.48262 13.958H9.75096C9.92362 13.958 10.0745 14.0132 10.206 14.1252C10.3366 14.2364 10.416 14.3757 10.4432 14.5429L11.4667 20.3233C11.4667 20.3311 11.4698 20.3342 11.4768 20.3342C11.4838 20.3342 11.487 20.3303 11.487 20.3233L12.5105 14.5118C12.5355 14.3564 12.6162 14.2153 12.7376 14.1151C12.8594 14.0134 13.013 13.9575 13.1716 13.9572C13.2402 13.956 13.308 13.9716 13.3692 14.0027C13.4303 14.0337 13.4829 14.0793 13.5224 14.1353C13.5686 14.185 13.6014 14.2456 13.6178 14.3115C13.6341 14.3773 13.6334 14.4463 13.6157 14.5118L12.2515 21.014C12.218 21.1795 12.1264 21.3277 11.9933 21.4317C11.8647 21.5351 11.7041 21.5904 11.5391 21.588H11.3213C11.1545 21.5899 10.9928 21.5304 10.8671 21.4208C10.7441 21.3114 10.6605 21.1646 10.6291 21.0031L9.60629 15.2227C9.60629 15.2149 9.60318 15.2118 9.59618 15.2118C9.58918 15.2118 9.58607 15.2157 9.58607 15.2227L8.56251 21.0031C8.53715 21.1669 8.45278 21.3157 8.32529 21.4216C8.19929 21.5312 8.03734 21.5908 7.87029 21.5888H7.65329C7.48501 21.5901 7.32119 21.5347 7.18818 21.4317C7.06023 21.3246 6.97291 21.1769 6.94085 21.0132L6.94162 21.014Z" fill="white"/><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7237 2.09617H23.0137C24.1881 2.09617 25.1409 3.05983 25.1409 4.24828V14.6581C25.1409 15.8465 24.1889 16.8094 23.0145 16.8094H18.7981V18.1285H23.0137C24.9084 18.1285 26.4445 16.5745 26.4445 14.6581V4.24828C26.4445 2.33105 24.9084 0.777832 23.0145 0.777832H12.7237C10.829 0.777832 9.2937 2.33105 9.2937 4.24828V8.33705H10.5965V4.24828C10.5965 3.05983 11.5485 2.09617 12.7237 2.09617Z" fill="#005EEB"/><path fill-rule="evenodd" clip-rule="evenodd" d="M13.7246 6.0962C13.7246 5.73142 14.0163 5.43665 14.3764 5.43665H21.4145C21.7746 5.43665 22.0663 5.7322 22.0663 6.0962C22.0671 6.26996 21.9989 6.43694 21.8767 6.56047C21.7545 6.68399 21.5883 6.75395 21.4145 6.75498H14.3756C14.202 6.75375 14.0359 6.68369 13.9139 6.56019C13.7919 6.43669 13.7238 6.26983 13.7246 6.0962Z" fill="#005EEB"/><path fill-rule="evenodd" clip-rule="evenodd" d="M23.0144 0.777832C24.9083 0.777832 26.4444 2.33105 26.4444 4.24828V14.6581C26.4444 16.5745 24.9083 18.1285 23.0144 18.1285H18.7981V16.8094H23.0136C24.1881 16.8094 25.1408 15.8465 25.1408 14.6581V4.24828C25.1408 3.05983 24.1888 2.09617 23.0144 2.09617H12.7236C11.5492 2.09617 10.5964 3.05983 10.5964 4.24828V8.33705H9.29285V4.24828C9.29285 2.33105 10.829 0.777832 12.7228 0.777832H23.0144Z" fill="#005EEB"/><path fill-rule="evenodd" clip-rule="evenodd" d="M18.9381 9.34815C18.9381 8.98415 19.1567 8.6886 19.4266 8.6886H21.5771C21.8478 8.6886 22.0663 8.98415 22.0663 9.34815C22.0663 9.71215 21.8478 10.0069 21.5771 10.0069H19.4266C19.1567 10.0069 18.9381 9.71138 18.9381 9.34815ZM18.9381 12.6C18.9381 12.236 19.2298 11.9413 19.5899 11.9413H21.4146C21.7747 11.9413 22.0663 12.2368 22.0663 12.6C22.0669 12.6861 22.0504 12.7715 22.0179 12.8513C21.9854 12.931 21.9376 13.0036 21.8771 13.0648C21.8165 13.1261 21.7445 13.1748 21.6652 13.2082C21.5858 13.2416 21.5007 13.2591 21.4146 13.2596H19.5899C19.5038 13.2591 19.4186 13.2416 19.3393 13.2082C19.2599 13.1748 19.1879 13.1261 19.1274 13.0648C19.0669 13.0036 19.019 12.931 18.9865 12.8513C18.9541 12.7715 18.9376 12.6861 18.9381 12.6Z" fill="#005EEB"/></svg>
                                <div class="page-title">Word to PDF</div>
                            </div>
                        </div>
                        <div class="handle-upload" id="handle-upload">
                            <div style="width:100%">
                                <div class="ready-convert">
                                    <div class="pdf-items" id="pdfItems"></div>
                                    <div class="upload-more"><label for="file" class="btn-upload-more"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4.5C12.4142 4.5 12.75 4.83579 12.75 5.25V11.25H18.75C19.1642 11.25 19.5 11.5858 19.5 12C19.5 12.4142 19.1642 12.75 18.75 12.75H12.75V18.75C12.75 19.1642 12.4142 19.5 12 19.5C11.5858 19.5 11.25 19.1642 11.25 18.75V12.75H5.25C4.83579 12.75 4.5 12.4142 4.5 12C4.5 11.5858 4.83579 11.25 5.25 11.25H11.25V5.25C11.25 4.83579 11.5858 4.5 12 4.5Z" fill="#363539"/></svg></label></div>
                                    <div class="only-pc">
                                        <div class="upload-more convert-now">
                                        <button type="button" class="btn btn-convert only-pc" onclick="handleConvert()">Convert now<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_58_608)"><path d="M12.5 4L11.09 5.41L16.67 11H4.5V13H16.67L11.09 18.59L12.5 20L20.5 12L12.5 4Z" fill="white"/></g><defs><clipPath id="clip0_58_608"><rect width="24" height="24" fill="white" transform="translate(0.5)"/></clipPath></defs></svg></button>
                                        </div>
                                    </div>    
                                    
                                </div>

                            </div>
                        </div>
                        <div class="task-processing" id="task-process">
                            <div class="lds-spinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
                            <div class="processing-title">Your task is processing</div>
                            <span>Please wait...</span>
                        </div>
                    </div>
                    <div class="download-wrapper" id="download-final">
                        <div class="title-wrapper">
                            <div class="title-page">
                            <svg width="33" height="33" viewBox="0 0 33 33" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.5 3.5C9.33187 3.5 3.5 9.33187 3.5 16.5C3.5 23.6681 9.33187 29.5 16.5 29.5C23.6681 29.5 29.5 23.6681 29.5 16.5C29.5 9.33187 23.6681 3.5 16.5 3.5ZM23.2656 12.1431L14.8656 22.1431C14.7735 22.2529 14.6588 22.3415 14.5294 22.4031C14.4 22.4647 14.2589 22.4977 14.1156 22.5H14.0988C13.9586 22.4999 13.82 22.4704 13.692 22.4134C13.564 22.3563 13.4494 22.273 13.3556 22.1688L9.75562 18.1688C9.6642 18.0718 9.59308 17.9575 9.54644 17.8327C9.49981 17.7078 9.4786 17.5749 9.48407 17.4417C9.48953 17.3086 9.52156 17.1778 9.57827 17.0572C9.63498 16.9366 9.71523 16.8286 9.81429 16.7394C9.91336 16.6503 10.0293 16.5818 10.1551 16.5381C10.281 16.4944 10.4144 16.4763 10.5474 16.4848C10.6804 16.4934 10.8104 16.5284 10.9296 16.5879C11.0489 16.6474 11.155 16.7301 11.2419 16.8312L14.0725 19.9762L21.7344 10.8569C21.9062 10.6582 22.1494 10.5351 22.4113 10.5142C22.6732 10.4934 22.9327 10.5764 23.1339 10.7454C23.3351 10.9143 23.4617 11.1557 23.4863 11.4172C23.5109 11.6788 23.4317 11.9395 23.2656 12.1431Z" fill="#05A85C"/></svg>
                            <div class="page-title">PDF has been converted!</div>
                            </div>
                        </div>
                        <div class="preview-download">
                            <div class="preview-file"><div class="file-info">
                                <svg width="72" height="72" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_203_545)"><path d="M12.0001 58.6667V65.3333C12.0001 65.687 12.1406 66.0261 12.3906 66.2761C12.6407 66.5262 12.9798 66.6667 13.3334 66.6667H58.6668C59.0204 66.6667 59.3595 66.5262 59.6096 66.2761C59.8596 66.0261 60.0001 65.687 60.0001 65.3333V16.8293V17.3333H48.0001V5.33333H48.6094H13.3334C12.9798 5.33333 12.6407 5.47381 12.3906 5.72386C12.1406 5.97391 12.0001 6.31304 12.0001 6.66667V41.3333H38.6708C40.1414 41.3333 41.3334 42.5253 41.3334 44.004V55.996C41.334 56.3462 41.2655 56.6931 41.132 57.0168C40.9984 57.3405 40.8025 57.6348 40.5552 57.8828C40.308 58.1308 40.0143 58.3277 39.6909 58.4622C39.3676 58.5966 39.021 58.6661 38.6708 58.6667H12.0001ZM10.6668 58.6667H9.32942C8.97913 58.6665 8.63231 58.5972 8.30882 58.4629C7.98533 58.3285 7.69151 58.1316 7.44419 57.8836C7.19687 57.6355 7.0009 57.3411 6.8675 57.0172C6.73409 56.6933 6.66588 56.3463 6.66676 55.996V44.004C6.66623 43.6538 6.73469 43.3069 6.86821 42.9832C7.00174 42.6595 7.19772 42.3652 7.44498 42.1172C7.69223 41.8692 7.9859 41.6724 8.30924 41.5379C8.63257 41.4034 8.97923 41.3339 9.32942 41.3333H10.6668V6.66667C10.6668 5.95942 10.9477 5.28115 11.4478 4.78105C11.9479 4.28095 12.6262 4 13.3334 4H48.6094C48.962 3.99989 49.3112 4.06972 49.6366 4.20544C49.9621 4.34115 50.2574 4.54007 50.5054 4.79067L60.5628 14.9547C61.0564 15.4538 61.3333 16.1274 61.3334 16.8293V65.3333C61.3334 66.0406 61.0525 66.7189 60.5524 67.219C60.0523 67.7191 59.374 68 58.6668 68H13.3334C12.6262 68 11.9479 67.7191 11.4478 67.219C10.9477 66.7189 10.6668 66.0406 10.6668 65.3333V58.6667ZM59.7108 16C59.6807 15.9623 59.6487 15.9262 59.6148 15.892L49.5574 5.72933C49.4896 5.66051 49.4145 5.59926 49.3334 5.54667V16H59.7108ZM22.6668 36H50.6668V37.3333H22.6668V36ZM22.6668 29.3333H50.6668V30.6667H22.6668V29.3333ZM44.0001 42.6667H50.6668V44H44.0001V42.6667ZM44.0001 49.3333H50.6668V50.6667H44.0001V49.3333ZM44.0001 56H50.6668V57.3333H44.0001V56ZM18.9934 48.1173C18.9934 47.132 18.6934 46.3907 18.0921 45.8933C17.4908 45.3973 16.6121 45.148 15.4588 45.148H12.4188V54.6667H14.4361V51.28H15.3028C16.4828 51.28 17.3934 51.0093 18.0334 50.4667C18.6734 49.9253 18.9934 49.1413 18.9934 48.1173ZM14.4361 49.6267V46.8H15.3548C15.9054 46.8 16.3108 46.9133 16.5681 47.1387C16.8268 47.3653 16.9548 47.7147 16.9548 48.188C16.9548 48.656 16.8014 49.0133 16.4934 49.2587C16.1854 49.504 15.7201 49.6267 15.1001 49.6267H14.4361ZM28.6881 49.8147C28.6881 48.344 28.2574 47.1973 27.3988 46.3773C26.5388 45.5573 25.3321 45.1467 23.7788 45.1467H20.7908V54.6667H23.4854C25.1694 54.6667 26.4588 54.2507 27.3494 53.416C28.2428 52.5827 28.6881 51.3827 28.6881 49.816V49.8147ZM26.5908 49.868C26.5908 51.9547 25.6188 52.9987 23.6748 52.9987H22.8081V46.8013H23.8828C25.6881 46.8013 26.5908 47.8227 26.5908 49.868ZM32.6454 54.6667V50.904H35.8748V49.256H32.6454V46.8027H36.1161V45.1493H30.6601V54.6667H32.6468H32.6454Z" fill="#D71919"/></g><defs><clipPath id="clip0_203_545"><rect width="64" height="64" fill="white" transform="translate(4 4)"/></clipPath></defs></svg>
                                <div class="pdf-filename" id="downloadFilename"></div><div class="pdf-file-size" id="dlFileSize"></div></div></div>
                        </div>
                        <div class="mt-4 justify-center">
                            <a type="button" class="btn btn-primary btn-convert" href="#" id="download-btn">Download now<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.5 9H15.5V3H9.5V9H5.5L12.5 16L19.5 9ZM5.5 18V20H19.5V18H5.5Z" fill="white"/></svg></a>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
        
        <div class="converter-footer">
            <div class="container">
                <div class="upload-more convert-now">
                    <button type="button" class="btn btn-convert" onclick="handleConvert()">Convert now<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_58_608)"><path d="M12.5 4L11.09 5.41L16.67 11H4.5V13H16.67L11.09 18.59L12.5 20L20.5 12L12.5 4Z" fill="white"/></g><defs><clipPath id="clip0_58_608"><rect width="24" height="24" fill="white" transform="translate(0.5)"/></clipPath></defs></svg></button>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="/assets/js/jquery.dm-uploader.min.js"></script>
<script src="/assets/js/ui.js?v=<?=time()?>"></script>
<script>
function formatBytes(a,b=2){if(!+a)return"0 Bytes";const c=0>b?0:b,d=Math.floor(Math.log(a)/Math.log(1024));return`${parseFloat((a/Math.pow(1024,d)).toFixed(c))} ${["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][d]}`}
var pdfs = [];

$("#drop-area").dmUploader({
    url: '/upload.php',
    headers: {
    'Access-Control-Allow-Origin': "*"
    },
    onNewFile: function(id, file){
      showPreview(id, file);
    },
    onUploadProgress: function(id, percent) {
        // Updating file progress
        update_file_progress(id, percent);
    },
    onUploadSuccess: function(id, data) {
        // A file was successfully uploaded
        update_file_status(id, data);
    },
    onUploadError: function(id, xhr, status, message) {
        update_file_progress(id, 0, 'danger', false);
        updateError(id, 0);
    },
    onInit: function() {
        console.log('Callback: Plugin initialized');
    },
});

function updateError () {
    console.log(0);
}
function removeItem(id) {
    $("#" + id).remove();
    if ($(".pdf-item").length === 0) {
        $('#upload').removeClass('disabled');
        $('#converter').removeClass('d-block');
        $('#convert-wrapper').removeClass('disabled');
        $('#handle-upload').addClass('active');
    }
}

function showPreview(id, file) {
    if(file.type === "application/vnd.openxmlformats-officedocument.wordprocessingml.document" || file.type === "application/msword") {
        console.log('ok');
        $('#pdfItems').append('<div class="pdf-item" id="' + id + '" data-filename="' + file.name.replace(/\.[^/.]+$/, "") + '"><div class="file-info"><svg width="72" height="72" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M63.2945 18.253L49.7112 4.66972C49.4996 4.45671 49.2478 4.28783 48.9704 4.17287C48.693 4.05791 48.3955 3.99915 48.0952 4.00001H17.488C16.2278 4.00001 15.2023 5.02553 15.2023 6.28572V65.7143C15.2023 66.9745 16.2278 68 17.488 68H61.6785C62.9387 68 63.9642 66.9745 63.9642 65.7143V19.869C63.9642 19.2594 63.7257 18.685 63.2945 18.253ZM48.7261 5.83925L62.1249 19.2381H49.488C49.2859 19.2381 49.0921 19.1578 48.9492 19.0149C48.8064 18.8721 48.7261 18.6783 48.7261 18.4762V5.83925ZM61.6785 66.4762H17.488C17.2859 66.4762 17.0921 66.3959 16.9492 66.253C16.8064 66.1101 16.7261 65.9164 16.7261 65.7143V6.28572C16.7261 6.08365 16.8064 5.88986 16.9492 5.74698C17.0921 5.60409 17.2859 5.52382 17.488 5.52382H47.2023V18.4762C47.2023 19.7364 48.2278 20.7619 49.488 20.7619H62.4404V65.7143C62.4404 65.9164 62.3601 66.1101 62.2172 66.253C62.0743 66.3959 61.8805 66.4762 61.6785 66.4762Z" fill="#185ABD"/><path d="M56.3008 51.5146H36.8269V53.0385H56.3008C56.4852 53.0385 56.6621 52.9582 56.7925 52.8153C56.923 52.6724 56.9962 52.4786 56.9962 52.2766C56.9962 52.0745 56.923 51.8807 56.7925 51.7378C56.6621 51.5949 56.4852 51.5146 56.3008 51.5146Z" fill="#185ABD"/><path d="M56.3008 45.7429H36.8269V47.2667H56.3008C56.4852 47.2667 56.6621 47.1865 56.7925 47.0436C56.923 46.9007 56.9962 46.7069 56.9962 46.5048C56.9962 46.3028 56.923 46.109 56.7925 45.9661C56.6621 45.8232 56.4852 45.7429 56.3008 45.7429Z" fill="#185ABD"/><path d="M36.8269 41.495H56.3008C56.4852 41.495 56.6621 41.4147 56.7925 41.2718C56.923 41.129 56.9962 40.9352 56.9962 40.7331C56.9962 40.531 56.923 40.3372 56.7925 40.1943C56.6621 40.0515 56.4852 39.9712 56.3008 39.9712H36.8269V41.495Z" fill="#185ABD"/><path d="M56.3008 34.1997H36.8269V35.7235H56.3008C56.4852 35.7235 56.6621 35.6432 56.7925 35.5004C56.923 35.3575 56.9962 35.1637 56.9962 34.9616C56.9962 34.7595 56.923 34.5657 56.7925 34.4229C56.6621 34.28 56.4852 34.1997 56.3008 34.1997Z" fill="#185ABD"/><path d="M10.3312 55.4771H28.694C29.3028 55.4771 29.8866 55.2353 30.3171 54.8049C30.7475 54.3744 30.9894 53.7906 30.9894 53.1818V34.819C30.9894 34.2103 30.7475 33.6264 30.3171 33.196C29.8866 32.7655 29.3028 32.5237 28.694 32.5237H10.3312C9.72247 32.5237 9.13864 32.7655 8.70818 33.196C8.27772 33.6264 8.03589 34.2103 8.03589 34.819V53.1818C8.03589 53.7906 8.27772 54.3744 8.70818 54.8049C9.13864 55.2353 9.72247 55.4771 10.3312 55.4771Z" fill="#185ABD"/><path d="M15.8544 47.8135C15.8923 48.113 15.9169 48.3741 15.929 48.5973H15.972C16.0247 48.0854 16.1065 47.577 16.2171 47.0744L18.245 38.262H20.8674L22.9654 46.9424C23.0704 47.371 23.1582 47.9162 23.2276 48.5795H23.2626C23.2919 48.1222 23.3648 47.5937 23.4813 46.9952L25.1597 38.262H27.5463L24.6094 50.8864H21.8206L19.8184 42.5233C19.7605 42.2823 19.6945 41.9684 19.6216 41.581C19.5655 41.3013 19.5204 41.0196 19.4862 40.7363H19.4518C19.4282 40.9418 19.3829 41.2471 19.3158 41.6516C19.2677 41.952 19.2137 42.2514 19.1539 42.5497L17.2746 50.8864H14.4422L11.4789 38.262H13.9091L15.7362 47.0922C15.7769 47.2741 15.8165 47.5145 15.8544 47.814V47.8135Z" fill="#F9F7F7"/></svg><div class="pdf-filename">' + file.name + '</div><div class="pdf-file-size">' + formatBytes(file.size) + '</div></div><div class="progress-bar"></div><div class="item-del" onclick="removeItem(\'' + id + '\')"><svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.3268 6.00028L11.0377 2.28935C11.2139 2.11354 11.3129 1.87496 11.3131 1.62611C11.3134 1.37726 11.2147 1.13851 11.0389 0.962393C10.8631 0.786273 10.6245 0.687206 10.3757 0.686986C10.1268 0.686766 9.88807 0.785412 9.71195 0.961221L6.00102 4.67216L2.29008 0.961221C2.11396 0.785101 1.87509 0.686157 1.62602 0.686157C1.37694 0.686157 1.13807 0.785101 0.961953 0.961221C0.785833 1.13734 0.68689 1.37621 0.68689 1.62528C0.68689 1.87436 0.785833 2.11323 0.961953 2.28935L4.67289 6.00028L0.961953 9.71122C0.785833 9.88734 0.68689 10.1262 0.68689 10.3753C0.68689 10.6244 0.785833 10.8632 0.961953 11.0393C1.13807 11.2155 1.37694 11.3144 1.62602 11.3144C1.87509 11.3144 2.11396 11.2155 2.29008 11.0393L6.00102 7.32841L9.71195 11.0393C9.88807 11.2155 10.1269 11.3144 10.376 11.3144C10.6251 11.3144 10.864 11.2155 11.0401 11.0393C11.2162 10.8632 11.3151 10.6244 11.3151 10.3753C11.3151 10.1262 11.2162 9.88734 11.0401 9.71122L7.3268 6.00028Z" fill="#5C5D6B"></path></svg></div></div>');
        $('#upload').addClass('disabled');
        $('#converter').addClass('d-block');
        $('#convert-wrapper').removeClass('disabled');
        $('#handle-upload').addClass('active');
    }
}

function update_file_status(id, data) {
    const obj = JSON.parse(data);
    console.log(data);
    if (!obj.data.id) {
        console.log('Alert error');
    } else {
        pdfs.push({
            'id_upload': id,
            'id_be': obj.data.id
        });
        // console.log(pdfs);

    }

}


// UI 
function update_file_progress(id, percent, color, active) {
    console.log('id: ' + id + ' - ' + percent);
    color = (typeof color === 'undefined' ? false : color);
    active = (typeof active === 'undefined' ? true : active);

    var bar = $('#' + id).find('div.progress-bar');

    bar.width(percent + '%').attr('aria-valuenow', percent);
    bar.toggleClass('progress-bar-striped progress-bar-animated', active);

    // if (percent === 0){
    //   bar.html('');
    // } else {
    //   bar.html(percent + '%');
    // }

    if (color !== false) {
        bar.removeClass('bg-success bg-info bg-warning bg-danger');
        bar.addClass('bg-' + color);
    }
}

function handleConvert() {
    $('#handle-upload').removeClass('active');
    $('#task-process').addClass('active');
    $('.converter-footer').addClass('disabled');
	countPDF = $(".pdf-item").length;
    var items = [];
    var fileNames = [];
	for (var i = 0; i < countPDF; i++) {
        countPdfArr = pdfs.length;
        for (var j = 0; j < countPdfArr; j++) {
            if ($(".pdf-item")[i].id === pdfs[j]['id_upload']) {
                items.push(pdfs[j]['id_be']);
                filename = $("#" + pdfs[j]['id_upload']).data("filename");
                fileNames.push(filename);
            }
        }
	}

	$.ajax({
		url: "/tasks.php",
		method: "POST",

		data: {
			task: 'word2pdf',
            files: items,
            config: {
                file_names: fileNames
            }
		},
		success: function(response) {
            obj = jQuery.parseJSON(response);
            $('#convert-wrapper').addClass('disabled');
            $('#download-final').addClass('active');
            $("#download-btn").attr("href", obj.data.url);
            $("#downloadFilename").text('SnapPDF_c78099b30df94bb4999c3731acdadbd6.docx');
            $("#dlFileSize").text(formatBytes(obj.data.file_size));

		},
		error: function() {
			alert("error");
		}

	});
}
</script>
</body>
</html>